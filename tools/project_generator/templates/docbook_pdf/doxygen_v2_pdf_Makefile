XSLT=xsltproc
FO=fop
#BUILDTOOLS=/media/Extended/docbook
BUILDTOOLS=$DOCBOOK_PATH$
PDF_NAME=$PDF_NAME$
GRAPICS=$GRAPICS_PATH$
TRANSFORM=$TRANSFORM_PATH$

all: pdf

pdf: $(PDF_NAME)

$(PDF_NAME): xml/fo.xml
	cp $(GRAPICS)/AtmelLogo_2012* .
	$(FO) -c fop.xconf xml/fo.xml -pdf $(PDF_NAME)
	rm AtmelLogo_2012*

xml/fo.xml: xml/manual.xml
	$(XSLT) $(BUILDTOOLS)/pdf.xsl xml/manual.xml > xml/fo.xml

xml/manual.xml: xml/all_in_one.xml
	$(XSLT) $(TRANSFORM)/transform.xsl xml/all_in_one.xml > xml/manual.xml

xml/all_in_one.xml: xml/index.xml
	$(XSLT) xml/combine.xslt xml/index.xml > xml/all_in_one.xml

xml/index.xml:
	doxygen doxyfile.doxygen

clean:
	rm -f xml/index.xml xml/all_in_one.xml xml/manual.xml xml/fo.xml $(PDF_NAME)

.PHONY: all pdf clean